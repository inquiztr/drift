{"version":3,"sources":["../src/js/BoundingBox.js"],"names":["BoundingBox","options","isShowing","namespace","zoomFactor","containerEl","settings","openClasses","_buildClasses","_buildElement","suffix","classes","ns","push","el","document","createElement","zoomPaneWidth","zoomPaneHeight","appendChild","style","width","Math","round","height","removeChild","percentageOffsetX","percentageOffsetY","triggerRect","pageXOffset","window","pageYOffset","inlineLeft","left","clientWidth","inlineTop","top","clientHeight"],"mappings":";;;;;;;AAAA;;AACA;;;;;;;;;;IAEqBA,W;AACnB,uBAAYC,OAAZ,EAAqB;AAAA;;AACnB,SAAKC,SAAL,GAAiB,KAAjB;AADmB,6BAGyED,OAHzE,CAGXE,SAHW;AAAA,QAGXA,SAHW,mCAGC,IAHD;AAAA,8BAGyEF,OAHzE,CAGOG,UAHP;AAAA,QAGOA,UAHP,oCAGoB,8BAHpB;AAAA,+BAGyEH,OAHzE,CAGsCI,WAHtC;AAAA,QAGsCA,WAHtC,qCAGoD,8BAHpD;AAKnB,SAAKC,QAAL,GAAgB;AAAEH,MAAAA,SAAS,EAATA,SAAF;AAAaC,MAAAA,UAAU,EAAVA,UAAb;AAAyBC,MAAAA,WAAW,EAAXA;AAAzB,KAAhB;AAEA,SAAKE,WAAL,GAAmB,KAAKC,aAAL,CAAmB,MAAnB,CAAnB;;AAEA,SAAKC,aAAL;AACD;;;;kCAEaC,M,EAAQ;AACpB,UAAMC,OAAO,GAAG,iBAAUD,MAAV,EAAhB;AAEA,UAAME,EAAE,GAAG,KAAKN,QAAL,CAAcH,SAAzB;;AACA,UAAIS,EAAJ,EAAQ;AACND,QAAAA,OAAO,CAACE,IAAR,WAAgBD,EAAhB,cAAsBF,MAAtB;AACD;;AAED,aAAOC,OAAP;AACD;;;oCAEe;AACd,WAAKG,EAAL,GAAUC,QAAQ,CAACC,aAAT,CAAuB,KAAvB,CAAV;AACA,2BAAW,KAAKF,EAAhB,EAAoB,KAAKN,aAAL,CAAmB,cAAnB,CAApB;AACD;;;yBAEIS,a,EAAeC,c,EAAgB;AAClC,WAAKhB,SAAL,GAAiB,IAAjB;AAEA,WAAKI,QAAL,CAAcD,WAAd,CAA0Bc,WAA1B,CAAsC,KAAKL,EAA3C;AAEA,UAAMM,KAAK,GAAG,KAAKN,EAAL,CAAQM,KAAtB;AACAA,MAAAA,KAAK,CAACC,KAAN,aAAiBC,IAAI,CAACC,KAAL,CAAWN,aAAa,GAAG,KAAKX,QAAL,CAAcF,UAAzC,CAAjB;AACAgB,MAAAA,KAAK,CAACI,MAAN,aAAkBF,IAAI,CAACC,KAAL,CAAWL,cAAc,GAAG,KAAKZ,QAAL,CAAcF,UAA1C,CAAlB;AAEA,2BAAW,KAAKU,EAAhB,EAAoB,KAAKP,WAAzB;AACD;;;2BAEM;AACL,UAAI,KAAKL,SAAT,EAAoB;AAClB,aAAKI,QAAL,CAAcD,WAAd,CAA0BoB,WAA1B,CAAsC,KAAKX,EAA3C;AACD;;AAED,WAAKZ,SAAL,GAAiB,KAAjB;AAEA,8BAAc,KAAKY,EAAnB,EAAuB,KAAKP,WAA5B;AACD;;;gCAEWmB,iB,EAAmBC,iB,EAAmBC,W,EAAa;AAC7D,UAAMC,WAAW,GAAGC,MAAM,CAACD,WAA3B;AACA,UAAME,WAAW,GAAGD,MAAM,CAACC,WAA3B;AAEA,UAAIC,UAAU,GAAGJ,WAAW,CAACK,IAAZ,GAAmBP,iBAAiB,GAAGE,WAAW,CAACP,KAAnD,GAA2D,KAAKP,EAAL,CAAQoB,WAAR,GAAsB,CAAjF,GAAqFL,WAAtG;AACA,UAAIM,SAAS,GAAGP,WAAW,CAACQ,GAAZ,GAAkBT,iBAAiB,GAAGC,WAAW,CAACJ,MAAlD,GAA2D,KAAKV,EAAL,CAAQuB,YAAR,GAAuB,CAAlF,GAAsFN,WAAtG;;AAEA,UAAIC,UAAU,GAAGJ,WAAW,CAACK,IAAZ,GAAmBJ,WAApC,EAAiD;AAC/CG,QAAAA,UAAU,GAAGJ,WAAW,CAACK,IAAZ,GAAmBJ,WAAhC;AACD,OAFD,MAEO,IAAIG,UAAU,GAAG,KAAKlB,EAAL,CAAQoB,WAArB,GAAmCN,WAAW,CAACK,IAAZ,GAAmBL,WAAW,CAACP,KAA/B,GAAuCQ,WAA9E,EAA2F;AAChGG,QAAAA,UAAU,GAAGJ,WAAW,CAACK,IAAZ,GAAmBL,WAAW,CAACP,KAA/B,GAAuC,KAAKP,EAAL,CAAQoB,WAA/C,GAA6DL,WAA1E;AACD;;AAED,UAAIM,SAAS,GAAGP,WAAW,CAACQ,GAAZ,GAAkBL,WAAlC,EAA+C;AAC7CI,QAAAA,SAAS,GAAGP,WAAW,CAACQ,GAAZ,GAAkBL,WAA9B;AACD,OAFD,MAEO,IAAII,SAAS,GAAG,KAAKrB,EAAL,CAAQuB,YAApB,GAAmCT,WAAW,CAACQ,GAAZ,GAAkBR,WAAW,CAACJ,MAA9B,GAAuCO,WAA9E,EAA2F;AAChGI,QAAAA,SAAS,GAAGP,WAAW,CAACQ,GAAZ,GAAkBR,WAAW,CAACJ,MAA9B,GAAuC,KAAKV,EAAL,CAAQuB,YAA/C,GAA8DN,WAA1E;AACD;;AAED,WAAKjB,EAAL,CAAQM,KAAR,CAAca,IAAd,aAAwBD,UAAxB;AACA,WAAKlB,EAAL,CAAQM,KAAR,CAAcgB,GAAd,aAAuBD,SAAvB;AACD","sourcesContent":["import throwIfMissing from \"./util/throwIfMissing\";\r\nimport { addClasses, removeClasses } from \"./util/dom\";\r\n\r\nexport default class BoundingBox {\r\n  constructor(options) {\r\n    this.isShowing = false;\r\n\r\n    const { namespace = null, zoomFactor = throwIfMissing(), containerEl = throwIfMissing() } = options;\r\n\r\n    this.settings = { namespace, zoomFactor, containerEl };\r\n\r\n    this.openClasses = this._buildClasses(\"open\");\r\n\r\n    this._buildElement();\r\n  }\r\n\r\n  _buildClasses(suffix) {\r\n    const classes = [`drift-${suffix}`];\r\n\r\n    const ns = this.settings.namespace;\r\n    if (ns) {\r\n      classes.push(`${ns}-${suffix}`);\r\n    }\r\n\r\n    return classes;\r\n  }\r\n\r\n  _buildElement() {\r\n    this.el = document.createElement(\"div\");\r\n    addClasses(this.el, this._buildClasses(\"bounding-box\"));\r\n  }\r\n\r\n  show(zoomPaneWidth, zoomPaneHeight) {\r\n    this.isShowing = true;\r\n\r\n    this.settings.containerEl.appendChild(this.el);\r\n\r\n    const style = this.el.style;\r\n    style.width = `${Math.round(zoomPaneWidth / this.settings.zoomFactor)}px`;\r\n    style.height = `${Math.round(zoomPaneHeight / this.settings.zoomFactor)}px`;\r\n\r\n    addClasses(this.el, this.openClasses);\r\n  }\r\n\r\n  hide() {\r\n    if (this.isShowing) {\r\n      this.settings.containerEl.removeChild(this.el);\r\n    }\r\n\r\n    this.isShowing = false;\r\n\r\n    removeClasses(this.el, this.openClasses);\r\n  }\r\n\r\n  setPosition(percentageOffsetX, percentageOffsetY, triggerRect) {\r\n    const pageXOffset = window.pageXOffset;\r\n    const pageYOffset = window.pageYOffset;\r\n\r\n    let inlineLeft = triggerRect.left + percentageOffsetX * triggerRect.width - this.el.clientWidth / 2 + pageXOffset;\r\n    let inlineTop = triggerRect.top + percentageOffsetY * triggerRect.height - this.el.clientHeight / 2 + pageYOffset;\r\n\r\n    if (inlineLeft < triggerRect.left + pageXOffset) {\r\n      inlineLeft = triggerRect.left + pageXOffset;\r\n    } else if (inlineLeft + this.el.clientWidth > triggerRect.left + triggerRect.width + pageXOffset) {\r\n      inlineLeft = triggerRect.left + triggerRect.width - this.el.clientWidth + pageXOffset;\r\n    }\r\n\r\n    if (inlineTop < triggerRect.top + pageYOffset) {\r\n      inlineTop = triggerRect.top + pageYOffset;\r\n    } else if (inlineTop + this.el.clientHeight > triggerRect.top + triggerRect.height + pageYOffset) {\r\n      inlineTop = triggerRect.top + triggerRect.height - this.el.clientHeight + pageYOffset;\r\n    }\r\n\r\n    this.el.style.left = `${inlineLeft}px`;\r\n    this.el.style.top = `${inlineTop}px`;\r\n  }\r\n}\r\n"],"file":"BoundingBox.js"}